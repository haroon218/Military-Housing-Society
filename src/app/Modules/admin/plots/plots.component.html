<p-toolbar styleClass="mb-6">
  <ng-template #start>
      <p-button label="New" icon="pi pi-plus" severity="secondary" class="mr-2" (onClick)="openNew()" />
      <!-- <p-button severity="secondary" label="Delete" icon="pi pi-trash" outlined (onClick)="deleteSelectedProducts()" [disabled]="!selectedProducts || !selectedProducts.length" /> -->

    </ng-template>
  <!-- <ng-template #end>
      <p-button label="Export" icon="pi pi-upload" severity="secondary" (onClick)="exportCSV()" />
  </ng-template> -->
  
</p-toolbar>
<!-- Role Table -->
<p-table #dt [value]="plots" [loading]="loading" [rows]="20" [paginator]="true" [rowHover]="true"
[scrollable]="true" scrollHeight="50vh"  [totalRecords]="totalRecords" [lazy]="true"
currentPageReportTemplate="Showing {first} to {last} of {totalRecords} Blocks" [showCurrentPageReport]="true"
[rowsPerPageOptions]="[20,30,40]" >
<ng-template #caption>
   <div class="flex items-center justify-between w-full">
     <!-- Left Side -->
     <h5 class="m-0">Manage Plots</h5>
               <div class="flex items-center gap-3">
       
 
       <p-iconfield>
         <p-inputicon styleClass="pi pi-search" />
         <input pInputText type="text" placeholder="Search..."  />
       </p-iconfield>
     </div>
   </div>
 </ng-template>
 
<ng-template pTemplate="header">
  <tr>
      <th>Plot #</th>
        <th >Plot Size</th>
      <th >Block Name</th>
      <th>Action</th>
  </tr>
</ng-template>
<ng-template pTemplate="body" let-blockdata>

   @if(!loading && plots.length>0){
      <tr>
         
          <td >{{ blockdata.name }}</td>
          <td >{{ blockdata.houseSizeName }}</td>
          <td>{{ blockdata.blockName }}</td>

          <td>
              <p-button icon="pi pi-pencil" class="mr-2" [rounded]="true" [outlined]="true" 
              (click)="editProduct(blockdata)"/>
              <p-button icon="pi pi-trash" severity="danger" [rounded]="true" [outlined]="true" (click)="deletePermission(blockdata);deleteDialog = true" />
          </td>
      </tr>
   }
</ng-template>
<ng-template pTemplate="loadingbody">
   <tr *ngFor="let _ of skeletonRows">
       <td><p-skeleton></p-skeleton></td>
       <td><p-skeleton></p-skeleton></td>
       <td><p-skeleton></p-skeleton></td>
       <td><p-skeleton></p-skeleton></td>

       
   </tr>
</ng-template>
<ng-template pTemplate="emptymessage">
   <tr>
       <td colspan="6">
           <div style="
                   margin-top: 20px;
                   display: flex;
                   justify-content: center;
                   align-items: center;
                   width: 100%;
                   flex-direction: column;
                   color: #888;
               ">
               <i class="pi pi-exclamation-circle" style="font-size: 2rem; color: red;"></i>
               <div style="margin-top: 1rem;">{{error?error:'No Records Found'}}
               </div>
           </div>
       </td>
   </tr>
</ng-template>
</p-table>
<!-- Role Table -->

<!-- Add Role Popup  -->
<p-dialog [(visible)]="addRoleDialog" [style]="{ width: '450px' }" [header]="is_update?'Update Plot':'Add Plot'" [modal]="true"
[draggable]="false">
 <form [formGroup]="plotForm">
  <div class="flex flex-col gap-1">
      <label for="block" class="block font-bold mb-1">Block Name</label>
      <p-select [options]="areaList" id="block" placeholder="Select Block" formControlName="blockId" appendTo="body"
        optionLabel="name" optionValue="id"></p-select>
      @if (plotForm.get('blockId')?.touched && plotForm.get('blockId')?.hasError('required')) {
        <small class="text-red-500">Block selection is required</small>
      }
</div>

   <div class="flex flex-col gap-1">
          <label for="name" class="block font-bold mb-1">Plot #</label>
          <input type="text" pInputText id="name" placeholder="Enter Plot #" formControlName="name"/>
          @if (plotForm.get('name')?.touched && plotForm.get('name')?.hasError('required')) {
              <small class="text-red-500">Plot name is required</small>
          }
   </div>
<div class="flex flex-col gap-1">
      <label for="block" class="block font-bold mb-1">Plot Size</label>
      <p-select [options]="houseSizes" id="block" placeholder="Select Size" formControlName="houseSizeId" appendTo="body"
        optionLabel="name" optionValue="id"></p-select>
      @if (plotForm.get('houseSizeId')?.touched && plotForm.get('houseSizeId')?.hasError('required')) {
        <small class="text-red-500">Plot Size is required</small>
      }
</div>
   <div class="flex justify-end mt-3 gap-1" *ngIf="addRoleDialog">
       <p-button label="Cancel" icon="pi pi-times" text (click)="closeDialog();plotForm.reset()" />
       <p-button [label]="is_update?'Update':'Add'" icon="pi pi-check" (click)="is_update ? updatePermission():addPlot()" />
   </div>

  </form> 
</p-dialog>

<p-dialog [(visible)]="deleteDialog" [style]="{ width: '450px' }" header="Delete Role" [modal]="true"
[draggable]="false">
   <ng-template #content>
       <div class="flex">
          <i class="pi pi-exclamation-triangle" style="font-size: 15px;"></i>
          <span class="ml-2"> Are you sure you want to delete?</span>
      </div>
   </ng-template>

   <ng-template #footer>
      <p-button label="No"  (click)="deleteDialog = false" />
      <p-button label="Yes"  (click)="removeRole()" />
  </ng-template>
</p-dialog>